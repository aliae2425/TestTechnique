{% if field.value is empty %}
    <span class="badge badge-secondary">Aucun historique</span>
{% else %}
    <div data-controller="searchable-table">
        <div class="mb-3">
            <input type="text" 
                   class="form-control form-control-sm" 
                   placeholder="Rechercher..." 
                   data-searchable-table-target="input"
                   data-action="input->searchable-table#search">
        </div>

        <table class="table table-sm table-striped">
            <thead>
                <tr>
                    <th style="cursor: pointer" data-action="click->searchable-table#sort">
                        Titre <span class="sort-icon text-muted small">⇅</span>
                    </th>
                    <th style="cursor: pointer" data-action="click->searchable-table#sort">
                        Date <span class="sort-icon text-muted small">⇅</span>
                    </th>
                    <th style="cursor: pointer" data-action="click->searchable-table#sort">
                        Score <span class="sort-icon text-muted small">⇅</span>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for session in field.value %}
                    <tr data-searchable-table-target="row">
                        <td>{{ session.quizTemplate.Titre|default('Quiz supprimé') }}</td>
                    <td>{{ session.startAt ? session.startAt|date('d/m/Y H:i') : 'N/A' }}</td>
                    <td>
                        {% if session.finalScore is not null %}
                            <span class="badge {{ session.finalScore >= 50 ? 'badge-success' : 'badge-danger' }}">
                                {{ session.finalScore }}%
                            </span>
                        {% else %}
                            <span class="badge badge-warning">En cours</span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
{% endif %}
